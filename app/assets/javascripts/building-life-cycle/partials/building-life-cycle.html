
<!--
  ~ Copyright 2017 Maalka
  ~
  ~    Licensed under the Apache License, Version 2.0 (the "License");
  ~    you may not use this file except in compliance with the License.
  ~    You may obtain a copy of the License at
  ~
  ~        http://www.apache.org/licenses/LICENSE-2.0
  ~
  ~    Unless required by applicable law or agreed to in writing, software
  ~    distributed under the License is distributed on an "AS IS" BASIS,
  ~    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  ~    See the License for the specific language governing permissions and
  ~    limitations under the License.
  -->
<script> $('.tabular.menu .item').tab(); </script>

<div class="ui">
    <form class="ui form" novalidate name="forms.buildingLifeCycleForm" ng-cloak>
        <div class="ui container" style="padding-top:14px">
            <h1 class="ui center aligned block header">Life Cycle Tool</h1>
            <div class="ui hidden divider"></div>
            <div class="ui very padded secondary segment">
                <div class="ui stackable grid">
                    <div class="ui row">
                        <p>
                          Developed with support from the Department of Energy, the Building Life Cycle Tool tool offers municipalities 
                          and energy service providers a transparent, cost-effective approach to collecting and structuring building 
                          energy audit data in a standardized way.  
                        </p>
                        <p>
                          The Building Life Cycle Tool guides users in the collection of the 
                          most relevant building information that can be used to assess strategies for upgrading the building to run more 
                          efficiently. Users are guided by a dynamic survey for collecting data on the most important building Systems 
                          (e.g. HVAC, Ventilation, Lighting Systems) and relevant Measures (e.g. Boiler Improvements, Lighting Upgrades). 
                          In this way, users can follow a standardized approach for collecting initial Building Audit data, as each system 
                          and measure is defined by a set of associated, standardized fields. For information on how to use this tool, take a 
                          look at the <a href="https://lifecycle.maalka.com/#!/usecase">Use Case</a>.
                        </p>
                    </div>
                </div>
            </div>
            <div class="ui didving header"></div>
            <h2>BUILDING INFORMATION</h2>
            <div class="content">
                <files model="model.value" file="model.file"></files>
            </div>
            <div class="content" ng-if="model.file.name !== undefined && loadingFileFiller.attachmentName === undefined && !loadingFileFilter.loading">
                <button class="ui blue button" ng-click="submitFile()">
	                Upload
                </button>
            </div>
            <div class="ui very padded secondary segment">
                <div class="ui large form">
                    <div class="ui stackable grid">
                        <div class="ui row">
                            <div class="eight wide column">
                                <div class="required field">
                                    <label>Building Name</label>
                                    <input type="text" ng-model="building.buildingName">
                                </div>
                            </div>
                            <div class="eight wide column">
                                <div class="required field">
                                    <label>Street</label>
                                    <input type="text" ng-model="building.addressStreet">
                                </div>
                            </div>
                        </div>
                        <div class="ui row">
                            <div class="seven wide column">
                                <div class="required field">
                                    <label>City</label>
                                    <input type="text" ng-model="building.addressCity">
                                </div>
                            </div>
                            <div class="three wide column">
                                <div class="required field">
                                    <label>State</label>
                                    <select dropdown class="ui fluid dropdown" ng-model="building.addressState">
                                        <option value="">State</option>
                                        <option value="AL">Alabama</option>
                                        <option value="AK">Alaska</option>
                                        <option value="AZ">Arizona</option>
                                        <option value="AR">Arkansas</option>
                                        <option value="CA">California</option>
                                        <option value="CO">Colorado</option>
                                        <option value="CT">Connecticut</option>
                                        <option value="DE">Delaware</option>
                                        <option value="DC">District Of Columbia</option>
                                        <option value="FL">Florida</option>
                                        <option value="GA">Georgia</option>
                                        <option value="HI">Hawaii</option>
                                        <option value="ID">Idaho</option>
                                        <option value="IL">Illinois</option>
                                        <option value="IN">Indiana</option>
                                        <option value="IA">Iowa</option>
                                        <option value="KS">Kansas</option>
                                        <option value="KY">Kentucky</option>
                                        <option value="LA">Louisiana</option>
                                        <option value="ME">Maine</option>
                                        <option value="MD">Maryland</option>
                                        <option value="MA">Massachusetts</option>
                                        <option value="MI">Michigan</option>
                                        <option value="MN">Minnesota</option>
                                        <option value="MS">Mississippi</option>
                                        <option value="MO">Missouri</option>
                                        <option value="MT">Montana</option>
                                        <option value="NE">Nebraska</option>
                                        <option value="NV">Nevada</option>
                                        <option value="NH">New Hampshire</option>
                                        <option value="NJ">New Jersey</option>
                                        <option value="NM">New Mexico</option>
                                        <option value="NY">New York</option>
                                        <option value="NC">North Carolina</option>
                                        <option value="ND">North Dakota</option>
                                        <option value="OH">Ohio</option>
                                        <option value="OK">Oklahoma</option>
                                        <option value="OR">Oregon</option>
                                        <option value="PA">Pennsylvania</option>
                                        <option value="RI">Rhode Island</option>
                                        <option value="SC">South Carolina</option>
                                        <option value="SD">South Dakota</option>
                                        <option value="TN">Tennessee</option>
                                        <option value="TX">Texas</option>
                                        <option value="UT">Utah</option>
                                        <option value="VT">Vermont</option>
                                        <option value="VA">Virginia</option>
                                        <option value="WA">Washington</option>
                                        <option value="WV">West Virginia</option>
                                        <option value="WI">Wisconsin</option>
                                        <option value="WY">Wyoming</option>
                                    </select>
                                </div>
                            </div>
                            <div class="three wide column">
                                <div class="required field">
                                    <label>Zip Code</label>
                                    <input type="text" ng-model="building.addressZip">
                                </div>
                            </div>
                            <div class="three wide column">
                                <div class="required field">
                                    <label>Year Completed</label>
                                    <input type="text" ng-model="building.yearCompleted">
                                </div>
                            </div>
                        </div>
                        <div class="ui row">
                            <div class="three wide column">
                                <div class="required field">
                                    <label>Floors Above Grade</label>
                                    <input type="text" ng-model="building.numberOfFloorsAboveGrade">
                                </div>
                            </div>
                            <div class="three wide column">
                                <div class="required field">
                                    <label>Floors Below Grade</label>
                                    <input type="text" ng-model="building.numberOfFloorsBelowGrade">
                                </div>
                            </div>
                            <div class="seven wide column">
                                <div class="required field">
                                    <label>Use Type</label>
                                    <select
                                            dropdown
                                            class="ui dropdown" dropdown ng-model="building.useType">
                                        <option value="">Select</option>
                                        <option ng-repeat="useType in useTypes"
                                                value="{{useType}}">{{useType}}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="three wide column">
                                <div class="required field">
                                    <label>Floor Area (ft&#178)</label>
                                    <input type="text" ng-model="building.floorArea">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui hidden divider"></div>
            <div class="ui hidden divider"></div>
            <div class="ui stackable grid">
                <div class="row">
                    <div class="eleven wide column">                
                        <h2>SYSTEMS / MEASURES</h2>
                    </div>
                    <div class="five wide column">
                        <h2>REQUIRED FIELDS</h2>
                    </div>
                </div>
                <div class="row">
                    <div class="eleven wide column">
                        <div class="ui top attached tabular menu">
                            <div class="active item" data-tab="Assets">Systems</div>
                            <div class="inactive item" data-tab="Measures">Measures</div>
                        </div>
                        <div class="ui bottom attached active tab very padded segment" data-tab="Assets">
                            <div class="ui grid">
                                <div class="sixteen wide column">
                                    <div class="ui large form">

                                            <div class="field">
                                                <label>System Type</label>
                                                <select
                                                        dropdown
                                                        class="ui dropdown" dropdown
                                                        ma-change="selectedSystemCategoryChanged(value)"
                                                        ng-model="selectedSystemCategory.selected" required >
                                                    <option value="">Select</option>
                                                    <option ng-repeat="system in systemCategories"
                                                            value="{{system}}">{{system}}</option>
                                                </select>
                                            </div>

                                            <div>

                                                <div id="type1" ng-show="showType1">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/DomesticHotWaterSystem.html'"></div>
                                                </div>
                                                <div id="type2" ng-show="showType2">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/FanSystem.html'"></div>
                                                </div>
                                                <div id="type3" ng-show="showType3">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/HVACSystem.html'"></div>
                                                </div>
                                                <div id="type4" ng-show="showType4">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/FenestrationSystem.html'"></div>
                                                </div>
                                                <div id="type5" ng-show="showType5">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/HeatRecoverySystem.html'"></div>
                                                </div>
                                                <div id="type6" ng-show="showType6">
                                                    <div ng-include src="'javascripts/building-life-cycle/partials/LightingSystem.html'"></div>
                                                </div>

                                            </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ui hidden divider"></div>
                            <div class="padded row">
                                <div class="pointer" ng-click="addSystemToList()">
                                    <h2 class="ui right floated small blue header">
                                    ADD TO LIST
                                    <a data-tooltip = "Add system information to system list">
                                        <img class="ui right floated mini image" src="/assets/images/down-arrow-blue.svg" />
                                    </a>
                                    </h2>
                                </div>
                            </div>
                        </div>
                        <div class="ui bottom attached inactive tab very padded segment" data-tab="Measures">
                            <div class="ui large form">
                                <div class="ui stackable grid">
                                    <div class="ui sixteen wide column">
                                        <div class="required field">
                                            <label>Measure Type</label>
                                            <select
                                                    dropdown
                                                    class="ui dropdown" dropdown
                                                    ma-change="selectedMeasureCategoryChanged(value)"
                                                    ng-model="selectedMeasureCategory.selected" required>
                                                <option value="">Select</option>
                                                <option ng-repeat="category in measureCategories"
                                                        value="{{category}}">{{category}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="ui sixteen wide column">
                                        <div class="required field">
                                            <label >Detail</label>
                                            <select
                                                dropdown
                                                class="ui fluid dropdown"
                                                ma-change="selectedMeasureChanged()"
                                                ng-model="measure.selected"
                                                >
                                            <option value="">Select</option>
                                            <option ng-repeat="measure in availableMeasures"
                                                    value="{{measure}}">{{measure}}</option>
                                        </select>
                                        </div>
                                    </div>
                                    <div class="ui sixteen wide column">
                                        <div class="required field">
                                            <label >Implementation Status</label>
                                            <select dropdown class="ui fluid dropdown" ng-model="implementationStatus.selected">
                                                <option value="">Select</option>
                                                <option ng-repeat="implementationStatus in implementationStatuses"
                                                        value="{{implementationStatus}}">{{implementationStatus}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="ui two column row">
                                        <div class="column">
                                            <div class="required field">
                                                <label>Start Date</label>
                                                <div class = "ui icon input">
                                                    <i class="calendar icon"></i>
                                                    <input daterangepicker ng-model="measure.startDate">
                                                </div>
                                            </div>
                                        </div>
                                        <div class="column">
                                            <div class="required field">
                                                <label>End Date</label>
                                                <div class = "ui icon input">
                                                    <i class="calendar icon"></i>
                                                    <input daterangepicker
                                                           min-date = "measure.startDate"
                                                           ng-model="measure.endDate">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <!--
                                    <div class="ui sixteen wide column">
                                        <div class="required field">
                                            <label >System Category</label>
                                            <select dropdown class="ui fluid dropdown" ng-model="systemCategory.selected">
                                                <option value="">Select</option>
                                                <option ng-repeat="systemCategory in systemCategories"
                                                        value="{{systemCategory}}">{{systemCategory}}</option>
                                            </select>
                                        </div>
                                    </div>
                                    -->
                                    <div class="ui sixteen wide column">
                                        <div class="field">
                                            <label>Comments</label>
                                            <textarea rows="3" ng-model="measure.comment"></textarea>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="ui hidden divider"></div>
                            <div class="row">
                                <div class="pointer" ng-click="addMeasureToList()">
                                    <h2 class="ui right floated small blue header">
                                    ADD TO LIST
                                    <a data-tooltip = "Add measure information to measures list">
                                        <img class="ui right floated mini image" src="/assets/images/down-arrow-blue.svg" />
                                    </a>
                                    </h2>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="five wide column">
                        <div class="ui padded secondary segment" style="height:350px">
                            <table class="ui very basic table">
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:HVACSystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:HVACSystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    <td>
                                        HVAC Systems
                                    </td>
                                </tr>
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:DomesticHotWaterSystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:DomesticHotWaterSystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    <td>
                                        Domestic Home Water Systems
                                    </td>
                                </tr>
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:FanSystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:FanSystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    <td>
                                        Fan Systems
                                    </td>
                                </tr>
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:FenestrationSystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:FenestrationSystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    <td>
                                        Fenestration Systems
                                    </td>
                                </tr>
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:HeatRecoverySystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:HeatRecoverySystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    <td>
                                        Heat Recovery Systems
                                    </td>
                                </tr>
                                <tr>
                                    <td class="top aligned collapsing">
                                        <img ng-if="systemAdded('auc:LightingSystems')" class="ui avatar image" src="/assets/images/check-blue-light.svg"/>
                                        <img ng-if="!systemAdded('auc:LightingSystems')" class="ui avatar image" src="/assets/images/x-red-light.svg"/>
                                    </td>
                                    </td>
                                    <td>
                                        Lighting Systems
                                    </td>
                                </tr>
                            </table>
                        </div>                                 
                    </div>
                </div>
            </div>
            <div class="ui hidden divider"></div>
            <div class="ui hidden divider"></div>
            <div class="ui two column grid">
                <div class="column">                
                    <h2>SYSTEMS</h2>
                    <div class="ui secondary segment" style="height:400px; overflow:scroll">
                        <div class="details">

                            <div ng-repeat="system in systemList track by $index">
                                <div class="fluid accordion">
                                    <div id='output'></div>
                                    <div class="active title">
                                        <button class="ui mini circular icon button" ng-click="removeSystem($index)">
                                            <i class="remove icon"></i>
                                        </button>
                                        {{getFirstKey(system) | systemLabel | titleCase}}
                                        <i class="blue dropdown icon"></i>
                                    </div>
                                    <div class="active content">
                                        <div>
                                            <render-system system="system"></render-system>
                                        </div>
                                    </div>
                                </div>
                                <div class="ui hidden divider"></div>
                            </div>
                        </div>
                    </div>
                    <button ng-if="measures.list.length > 0 || systemList.length > 0" class="ui blue button" ng-click="downloadData()">Download BuildingSync</button>
                    <button ng-if="measures.list.length > 0 || systemList.length > 0" class="ui blue button" ng-click="downloadXls()">Download XLS</button>

                </div>
                <div class="column">
                    <h2>MEASURES</h2>
                    <div class="ui secondary segment" style="height:400px; overflow:scroll">
                        <div class="details">
                            <div ng-repeat="measure in measures.list track by $index">
                                <div class="fluid accordion">
                                    <div class="active title">
                                        <button class="ui mini circular icon button" ng-click="removeMeasure($index)">
                                            <i class="remove icon"></i>
                                        </button>
                                        {{measure.systemType}}
                                        <i class="blue dropdown icon"></i>
                                    </div>
                                    <div class="indent">
                                        <div class="active content">
                                            <div style="color:#06a1f9">
                                                {{measure.startDate | date:'MM/dd/yyyy' }} -
                                                {{measure.endDate | date:'MM/dd/yyyy' }}
                                            </div>
                                            <div class="subtitle">
                                            {{measure.detail}}
                                            </div>  
                                            <div class="indent">
                                                <div><span style="color:black">Status: </span>{{measure.implementationStatus}}</div>
                                                <div><span style="color:black">System Category: </span>{{measure.systemCategory}}</div>
                                                <div><i><span style="color:black">Comment: </span>{{measure.comment}}</i></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="ui hidden divider"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="ui hidden divider"></div>
            <div class="ui hidden divider"></div>
            <div class="row" ng-if="measures.list.length > 0">
                <h2>TIMELINE</h2>
                    <p ng-if="measures.list.length < 1">Add a measure</p>
                    <div class="ui secondary segment" style="height:325px">
                        <div timeline-graph data-measures="measures.list"></div>
                    </div>
                </div>
            </div>
        <div class="ui hidden divider"></div>
    </form>
</div>


